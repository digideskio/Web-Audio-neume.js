!function t(e,n,i){function o(u,s){if(!n[u]){if(!e[u]){var a="function"==typeof require&&require;if(!s&&a)return a(u,!0);if(r)return r(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[u]={exports:{}};e[u][0].call(l.exports,function(t){var n=e[u][1][t];return o(n?n:t)},l,l.exports,t,e,n,i)}return n[u].exports}for(var r="function"==typeof require&&require,u=0;u<i.length;u++)o(i[u]);return o}({1:[function(t,e){"use strict";var n=t("./src/");n.use(t("./src/ugen/")),"undefined"!=typeof window&&(window.neume=n),e.exports=n},{"./src/":21,"./src/ugen/":41}],2:[function(t,e){"use strict";function n(t,e){r.call(this),this.$context=t,this.$outlet=null,this._node=i.defaults(e,null)}var i=t("../util"),o=t("../namespace"),r=t("../event/emitter");i.inherits(n,r),n.$name="NeuComponent",n.prototype.mul=function(t){return new o.Mul(this.$context,i.defaults(this._node,this),i.defaults(t,1))},n.prototype.add=function(t){return new o.Sum(this.$context,[i.defaults(this._node,this),i.defaults(t,0)])},n.prototype.toAudioNode=function(){return null===this.$outlet&&(this.$outlet=this.$context.toAudioNode(i.defaults(this._node,this))),this.$outlet},n.prototype.connect=function(t){return this.$context.connect(i.defaults(this._node,this),t),this},n.prototype.disconnect=function(){return this.$context.disconnect(i.defaults(this._node,this)),this},e.exports=n},{"../event/emitter":20,"../namespace":22,"../util":54}],3:[function(t,e){(function(n){"use strict";function i(t,e){a.call(this,t),this._value=s.finite(e)}function o(t,e){for(var n=new Float32Array(t),i=0;t>i;i++)n[i]=e;return n}function r(t,e){var n=null,i=t.createBuffer(1,u.DC_BUF_SIZE,t.sampleRate),o=n=t.createBufferSource();return i.getChannelData(0).set(0===e?c:l),o.buffer=i,o.loop=!0,o.start(0),0!==e&&1!==e&&(n=t.createGain(),n.gain.value=s.finite(e),t.connect(o,n)),n}var u=t("../const"),s=t("../util"),a=t("./component"),c=new o(u.DC_BUF_SIZE,0),l=new o(u.DC_BUF_SIZE,1);s.inherits(i,a),i.$name="NeuDC",i.prototype.toAudioNode=function(){return null===this.$outlet&&(this.$outlet=r(this.$context,this._value)),this.$outlet},i.prototype.connect=function(t){return t instanceof n.AudioParam?t.value=this._value:this.$context.connect(this.toAudioNode(),t),this},i.prototype.disconnect=function(){return this.$context.disconnect(this.$outlet),this},i.prototype.valueOf=function(){return this._value},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../const":8,"../util":54,"./component":2}],4:[function(t,e){"use strict";function n(t,e,n,i){if(a.call(this,t),i=i.valueOf(),"number"==typeof i){if(0===i)return new s.Component(t,e);if(1===i)return new s.Component(t,n)}this._dryIn=e,this._wetIn=n,this._mixIn=i}function i(t,e,n,i){i=u.clip(u.finite(i),0,1);var o=t.createGain(),r=t.createGain(),s=t.createGain();return o.gain.value=i,r.gain.value=1-i,t.connect(e,r),t.connect(n,o),t.connect(o,s),t.connect(r,s),s}function o(t,e,n,i){var o=t.createGain(),r=t.createGain(),u=t.createGain(),s=t.createWaveShaper(),a=t.createWaveShaper();return s.curve=l,a.curve=f,t.connect(i,s),t.connect(i,a),o.gain.value=0,r.gain.value=0,t.connect(s,o.gain),t.connect(a,r.gain),t.connect(e,r),t.connect(n,o),t.connect(o,u),t.connect(r,u),u}var r=t("../const"),u=t("../util"),s=t("../namespace"),a=t("./component"),c=r.WS_CURVE_SIZE,l=new Float32Array(c),f=new Float32Array(c);!function(){for(var t=c>>1,e=0;t>e;e++)l[e]=0,f[e]=1,l[e+t]=Math.sin(e/t*Math.PI*.5),f[e+t]=Math.cos(e/t*Math.PI*.5)}(),u.inherits(n,a),n.$name="NeuDryWet",n.prototype.toAudioNode=function(){if(null===this.$outlet){var t,e=this.$context;t="number"==typeof this._mixIn?i(e,this._dryIn,this._wetIn,this._mixIn):o(e,this._dryIn,this._wetIn,this._mixIn),this.$outlet=e.toAudioNode(t),this._dryIn=null,this._wetIn=null,this._mixIn=null}return this.$outlet},n.prototype.connect=function(t){return this.$context.connect(this.toAudioNode(),t),this},e.exports=n},{"../const":8,"../namespace":22,"../util":54,"./component":2}],5:[function(t,e){"use strict";function n(t,e,n){if(e=e.valueOf(),n=n.valueOf(),"number"==typeof e&&"number"==typeof n)return new o.DC(t,e*n);if(r.call(this,t),"number"==typeof e){var i=e;e=n,n=i}return 0===n?new o.DC(t,0):1===n?new o.Component(t,e):(this._a=e,void(this._b=n))}var i=t("../util"),o=t("../namespace"),r=t("./component");i.inherits(n,r),n.$name="NeuMul",n.prototype.mul=function(t){return t=t.valueOf(),"number"==typeof this._b&&"number"==typeof t?new o.Mul(this.$context,this._a,i.finite(this._b*t)):new o.Mul(this.$context,this.toAudioNode(),t)},n.prototype.toAudioNode=function(){return null===this.$outlet&&(this.$outlet=this.$context.createGain(),this.$outlet.gain.value=0,this.$context.connect(this._a,this.$outlet),this.$context.connect(this._b,this.$outlet.gain)),this.$outlet},n.prototype.connect=function(t){return this.$context.connect(this.toAudioNode(),t),this},n.prototype.disconnect=function(){return this.$context.disconnect(this.$outlet),this},e.exports=n},{"../namespace":22,"../util":54,"./component":2}],6:[function(t,e){(function(n){"use strict";function i(t,e,n){n=n||{},h.call(this,t),this._value=l.finite(e),this._params=[],this._events=[],this._curve=n.curve,this._lag=l.defaults(n.lag,0),this._scheduled=null}function o(t,e,n){var i=t._scheduled;null==i||i.time<=n||(t.cancelScheduledValues(i.time),t[i.method](e,n))}function r(t,e){var n,i,o=e.time,r=t._events,u=0;for(n=0,i=r.length;i>n;++n){if(r[n].time===o&&r[n].type===e.type){u=1;break}if(r[n].time>o)break}r.splice(n,u,e)}function u(t,e,n,i,o,r){var u=(i-o)/(r-o);return(1-u)*e+u*n}function s(t,e,n,i,o,r){var u=(i-o)/(r-o);return e>0&&n>0?e*Math.pow(n/e,u):t}function a(t,e,n,i,o){return e+(t-e)*Math.exp((i-n)/o)}function c(t,e,n,i,o){var r=(e-n)/(i-n);return 0>=r?l.defaults(o[0],t):r>=1?l.defaults(o[o.length-1],t):l.defaults(o[o.length*r|0],t)}var l=t("../util"),f=t("../namespace"),h=t("./component");l.inherits(i,h),i.$name="NeuParam",Object.defineProperties(i.prototype,{events:{get:function(){return this._events.slice()},enumerable:!0},value:{set:function(t){t=l.finite(t);var e=this._params;this._value=t;for(var n=0,i=e.length;i>n;n++)e[n].value=t},get:function(){return this._params.length?this._params[0].value:this._value},enumerable:!0}}),i.prototype.valueAtTime=function(t){t=l.finite(this.$context.toSeconds(t));for(var e,n=this._value,i=this._events,o=0;o<i.length;o++){var r=i[o],f=i[o+1];if(t<r.time)break;if(e=Math.min(t,f?f.time:t),f&&"LinearRampToValue"===f.type)n=u(n,r.value,f.value,e,r.time,f.time);else if(f&&"ExponentialRampToValue"===f.type)n=s(n,r.value,f.value,e,r.time,f.time);else switch(r.type){case"SetValue":case"LinearRampToValue":case"ExponentialRampToValue":n=r.value;break;case"SetTarget":n=a(n,r.value,e,r.time,r.timeConstant);break;case"SetValueCurve":n=c(n,e,r.time,r.time+r.duration,r.curve)}}return n},i.prototype.setAt=function(t,e){t=l.finite(t),e=l.finite(this.$context.toSeconds(e));for(var n=this._params,i=0,o=n.length;o>i;i++)n[i].setValueAtTime(t,e);return r(this,{type:"SetValue",value:t,time:e}),this},i.prototype.setValueAtTime=i.prototype.setAt,i.prototype.linTo=function(t,e){t=l.finite(t),e=l.finite(this.$context.toSeconds(e));for(var n=this._params,i=0,o=n.length;o>i;i++)n[i].linearRampToValueAtTime(t,e);return r(this,{type:"LinearRampToValue",value:t,time:e}),this},i.prototype.linearRampToValueAtTime=i.prototype.linTo,i.prototype.expTo=function(t,e){t=l.finite(t),e=l.finite(this.$context.toSeconds(e));for(var n=this._params,i=0,o=n.length;o>i;i++)n[i].exponentialRampToValueAtTime(t,e);return r(this,{type:"ExponentialRampToValue",value:t,time:e}),this},i.prototype.exponentialRampToValueAtTime=i.prototype.expTo,i.prototype.targetAt=function(t,e,n){t=l.finite(t),e=l.finite(this.$context.toSeconds(e)),n=l.finite(this.$context.toSeconds(n));for(var i=this._params,o=0,u=i.length;u>o;o++)i[o].setTargetAtTime(t,e,n);return r(this,{type:"SetTarget",value:t,time:e,timeConstant:n}),this},i.prototype.setTargetAtTime=i.prototype.targetAt,i.prototype.curveAt=function(t,e,n){e=l.finite(this.$context.toSeconds(e)),n=l.finite(this.$context.toSeconds(n));for(var i=this._params,o=0,u=i.length;u>o;o++)i[o].setValueCurveAtTime(t,e,n);return r(this,{type:"SetValueCurve",time:e,duration:n,curve:t}),this},i.prototype.setValueCurveAtTime=i.prototype.curveAt,i.prototype.cancel=function(t){t=l.finite(this.$context.toSeconds(t));var e,n,i=this._params,o=this._events;for(e=0,n=i.length;n>e;e++)i[e].cancelScheduledValues(t);for(e=0,n=o.length;n>e;++e)if(o[e].time>=t){o.splice(e);break}return this},i.prototype.cancelScheduledValues=i.prototype.cancel,i.prototype.update=function(t,e,n){var i=this.$context,r=e+l.finite(i.toSeconds(l.defaults(n,this._lag,0))),u=this.valueAtTime(e),s=this._curve,a=null;switch(o(this,u,e),e>=r&&(s="step"),s){case"exp":case"exponential":this.setValueAtTime(Math.max(1e-6,u),e),this.exponentialRampToValueAtTime(Math.max(1e-6,t),r),a={method:"exponentialRampToValueAtTime",time:r};break;case"lin":case"linear":this.setValueAtTime(u,e),this.linearRampToValueAtTime(t,r),a={method:"linearRampToValueAtTime",time:r};break;default:this.setValueAtTime(t,e)}return this._scheduled=a,this},i.prototype.toAudioNode=function(t){var e=this.$context;return null==this.$outlet&&(this.$outlet=e.createGain(),this.$outlet.gain.value=this._value,this._params.push(this.$outlet.gain),t?e.connect(t,this.$outlet):e.connect(new f.DC(e,1),this.$outlet)),this.$outlet},i.prototype.connect=function(t){return t instanceof n.AudioParam?(t.value=this._value,this._params.push(t)):this.$context.connect(this.toAudioNode(),t),this},i.prototype.disconnect=function(){return this.$context.disconnect(this.$outlet),this},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../namespace":22,"../util":54,"./component":2}],7:[function(t,e){"use strict";function n(t,e){r.call(this,t);for(var n=0,u=!1,s=null,a=[],c=0,l=e.length;l>c;c++){var f=e[c].valueOf();"number"==typeof f?(n+=i.finite(f),u=!0):!s&&f instanceof o.Param?s=f:a.push(f)}return 0===a.length?s?s:new o.DC(t,n):0===n&&null===s&&1===a.length?new o.Component(t,a[0]):(this._hasNumber=u,this._number=n,this._param=s,this._nodes=a,void(this._inputs=e))}var i=t("../util"),o=t("../namespace"),r=t("./component");i.inherits(n,r),n.$name="NeuSum",n.prototype.add=function(t){return new o.Sum(this.$context,this._inputs.concat(t))},n.prototype.toAudioNode=function(){if(null===this.$outlet){for(var t=this.$context,e=this._nodes,n=t.createGain(),i=0,o=e.length;o>i;i++)t.connect(e[i],n);this._param&&t.connect(this._param,n),this._number&&t.connect(this._number,n),this.$outlet=n}return this.$outlet},n.prototype.connect=function(t){for(var e=this.$context,n=this._number,i=this._param,r=this._nodes,u=0,s=r.length;s>u;u++)e.connect(e.toAudioNode(r[u]),t);return i?(e.connect(i,t),0!==n&&e.connect(new o.DC(e,n).toAudioNode(),t)):0!==n&&e.connect(n,t),this},n.prototype.disconnect=function(){for(var t=this.$context,e=this._inputs,n=0,i=e.length;i>n;n++)t.disconnect(e[n]);return this},e.exports=n},{"../namespace":22,"../util":54,"./component":2}],8:[function(t,e){"use strict";e.exports={PROCESS_BUF_SIZE:1024,DC_BUF_SIZE:128,WS_CURVE_SIZE:4096,MAX_RENDERING_SEC:180,MAX_DELAY_SEC:180,AUDIO_BUS_CHANNELS:1023,DEFAULT_MAX_NODES_OF_BUS:64}},{}],9:[function(t,e){"use strict";function n(t){this.$context=t,this.$outlet=t.createGain(),this.$maxNodes=i.DEFAULT_MAX_NODES_OF_BUS,this.$inputs=[],Object.defineProperties(this,{maxNodes:{set:function(t){this.$maxNodes=Math.max(0,o.int(t))},get:function(){return this.$maxNodes}},nodes:{get:function(){return this.$inputs.slice()}}})}var i=t("../const"),o=t("../util");n.$name="NeuAudioBus",n.prototype.fade=function(t,e,n){t=o.finite(this.$context.toSeconds(t))||this.$context.currentTime,e=o.finite(e),n=o.finite(this.$context.toSeconds(n));var i=this.$outlet.gain.value,r=e,u=i+.99*(r-i),s=-Math.max(1e-6,n)/Math.log((u-r)/(i-r));return this.$outlet.gain.setTargetAtTime(r,t,s),this.$outlet.gain.setValueAtTime(r,t+n),this},n.prototype.toAudioNode=function(){return this.$outlet},n.prototype.connect=function(t){return this.$context.connect(this.$outlet,t),this},n.prototype.disconnect=function(){return this},n.prototype.onconnected=function(t){var e=this.$inputs.indexOf(t);for(-1!==e&&this.$inputs.splice(e,1),this.$inputs.push(t);this.$maxNodes<this.$inputs.length;)this.$context.disconnect(this.$inputs.shift());t.$outputs=t.$outputs||[],-1===t.$outputs.indexOf(this)&&t.$outputs.push(this)},n.prototype.ondisconnected=function(t){var e=this.$inputs.indexOf(t);-1!==e&&this.$inputs.splice(e,1),t.$outputs&&(e=t.$outputs.indexOf(this),-1!==e&&t.$outputs.splice(e,1))},e.exports=n},{"../const":8,"../util":54}],10:[function(t,e){(function(n){"use strict";function i(t,e){this.$context=t,this._buffer=e,Object.defineProperties(this,{sampleRate:{value:this._buffer.sampleRate,enumerable:!0},length:{value:this._buffer.length,enumerable:!0},duration:{value:this._buffer.duration,enumerable:!0},numberOfChannels:{value:this._buffer.numberOfChannels,enumerable:!0}});for(var n=0;n<this._buffer.numberOfChannels;n++)Object.defineProperty(this,n,{value:this._buffer.getChannelData(n)})}function o(t){return new Promise(function(e,i){var o=new n.XMLHttpRequest;o.open("GET",t),o.responseType="arraybuffer",o.onload=function(){e(o.response)},o.onerror=function(){i({})},o.send()})}function r(t,e){return new Promise(function(n,i){t.decodeAudioData(e,function(t){n(t)},function(){i({})})})}function u(t){var e=s(t);if(0!==e)for(var n=1/e,i=0,o=t.length;o>i;++i)t[i]*=n;return t}function s(t){for(var e=0,n=0,i=t.length;i>n;++n){var o=Math.abs(t[n]);o>e&&(e=o)}return e}function a(t,e,n){return t.length===e?new Float32Array(t):n?l(t,e):c(t,e)}function c(t,e){for(var n=(t.length-1)/(e-1),i=new Float32Array(e),o=0;e>o;o++)i[o]=t[Math.round(o*n)];return i}function l(t,e){for(var n=(t.length-1)/(e-1),i=new Float32Array(e),o=t.length-1,r=0;e>r;r++){var u=r*n,s=0|u,a=Math.min(s+1,o);i[r]=t[s]+Math.abs(u-s)*(t[a]-t[s])}return i}var f=t("../util"),h=t("../dsp/fft");i.$name="NeuBuffer",i.create=function(t,e,n,o){return e=f.int(f.defaults(e,1)),n=f.int(f.defaults(n,0)),o=f.int(f.defaults(o,t.sampleRate)),new i(t,t.createBuffer(e,n,o))},i.from=function(t,e){var n=t.createBuffer(1,e.length,t.sampleRate);return n.getChannelData(0).set(e),new i(t,n)},i.load=function(t,e){return new Promise(function(n,u){o(e).then(function(e){return r(t,e)}).then(function(e){n(new i(t,e))}).catch(function(t){u(t)})})},i.prototype.getChannelData=function(t){return t=f.clip(f.int(t),0,this.numberOfChannels-1),this._buffer.getChannelData(t)},i.prototype.concat=function(){var t=f.toArray(arguments).filter(function(t){return t instanceof i&&this.numberOfChannels===t.numberOfChannels},this),e=this.numberOfChannels,n=t.reduce(function(t,e){return t+e.length},this.length),o=this.sampleRate,r=this.$context.createBuffer(e,n,o);t.unshift(this);for(var u=t.length,s=0;e>s;s++)for(var a=r.getChannelData(s),c=0,l=0;u>l;l++)a.set(t[l][s],c),c+=t[l].length;return new i(this.$context,r)},i.prototype.reverse=function(){for(var t=this.numberOfChannels,e=this.$context.createBuffer(t,this.length,this.sampleRate),n=0;t>n;n++)e.getChannelData(n).set(f.toArray(this[n]).reverse());return new i(this.$context,e)},i.prototype.slice=function(t,e){t=f.int(f.defaults(t,0)),e=f.int(f.defaults(e,this.length)),0>t?t+=this.length:t=Math.min(t,this.length),0>e?e+=this.length:e=Math.min(e,this.length);var n=this.numberOfChannels,o=e-t,r=this.sampleRate,u=null;if(0>=o)u=this.$context.createBuffer(n,1,r);else{u=this.$context.createBuffer(n,o,r);for(var s=0;n>s;s++)u.getChannelData(s).set(this[s].subarray(t,e))}return new i(this.$context,u)},i.prototype.split=function(t){if(t=f.int(f.defaults(t,2)),0>=t)return[];for(var e=new Array(t),n=this.length/t,i=0,o=0,r=0;t>r;r++)o=Math.round(i+n),e[r]=this.slice(i,o),i=o;return e},i.prototype.normalize=function(){for(var t=this.numberOfChannels,e=this.$context.createBuffer(t,this.length,this.sampleRate),n=0;t>n;n++)e.getChannelData(n).set(u(this[n]));return new i(this.$context,e)},i.prototype.resample=function(t,e){t=Math.max(0,f.int(f.defaults(t,this.length))),e=!!f.defaults(e,!0);for(var n=this.numberOfChannels,o=this.$context.createBuffer(n,t,this.sampleRate),r=0;n>r;r++)o.getChannelData(r).set(a(this[r],t,e));return new i(this.$context,o)},i.prototype.toAudioBuffer=function(){return this._buffer},i.prototype.toPeriodicWave=function(t){t=f.clip(f.int(t),0,this.numberOfChannels-1);var e=this._buffer.getChannelData(t);4096<e.length&&(e=e.subarray(0,4096));var n=h.forward(e);return this.$context.createPeriodicWave(n.real,n.imag)},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../dsp/fft":19,"../util":54}],11:[function(t,e){"use strict";function n(t,e,n){o.call(this,t,e,n)}var i=t("../util"),o=t("./sched");i.inherits(n,o),n.$name="NeuInterval",n.prototype._onsched=function(t){if(this._stopTime<=t)return this._state=o.STATE_STOP,void(this._stateString="FINISHED");this._stateString="PLAYING",this._callback({playbackTime:t,count:this._count++});var e=this.$context,n=i.finite(e.toSeconds(this._schedTime));n=Math.max(1/e.sampleRate,n),e.sched(t+n,this._onsched,this)},e.exports=n},{"../util":54,"./sched":12}],12:[function(t,e){"use strict";function n(t,e,i){this.$context=t,this._schedTime=e,this._callback=i,this._state=n.STATE_INIT,this._stateString="UNSCHEDULED",this._startTime=0,this._stopTime=1/0,this._count=0,Object.defineProperties(this,{context:{value:this.$context,enumerable:!0},state:{get:function(){return this._stateString},enumerable:!0}})}var i=t("../util");n.$name="NeuSched",n.STATE_INIT=0,n.STATE_START=1,n.STATE_STOP=2,n.prototype.start=function(t){var e=this.$context;return t=i.finite(i.defaults(e.toSeconds(t),e.currentTime)),this._state===n.STATE_INIT&&(i.isFunction(this._callback)?(this._state=n.STATE_START,this._stateString="SCHEDULED",this._startTime=t,e.sched(t,this._onsched,this)):(this._state=n.STATE_STOP,this._stateString="FINISHED"),e.start()),this},n.prototype.stop=function(t){var e=this.$context;return t=i.finite(i.defaults(e.toSeconds(t),e.currentTime)),this._state===n.STATE_START&&(this._state=n.STATE_STOP,this._stopTime=t,this.$context.sched(this._stopTime,function(){this._stateString="FINISHED"},this)),this},n.prototype._onsched=function(t){if(this._stopTime<=t)return this._state=n.STATE_STOP,void(this._stateString="FINISHED");this._stateString="PLAYING";var e=this._callback({playbackTime:t,count:this._count++}),o=this.$context;if("object"==typeof e){var r=i.finite(o.toSeconds(e.next));if(r>t)return i.isFunction(e.callback)&&(this._callback=e.callback),this._schedTime=r,o.sched(this._schedTime,this._onsched,this)}this._state=n.STATE_STOP,this._stopTime=t,this._stateString="FINISHED"},e.exports=n},{"../util":54}],13:[function(t,e){"use strict";function n(t,e,n){o.call(this,t,e,n)}var i=t("../util"),o=t("./sched");i.inherits(n,o),n.$name="NeuTimeout",n.prototype._onsched=function(t){if(this._count>1||this._stopTime<=t)return this._state=o.STATE_STOP,void(this._stateString="FINISHED");this._stateString="PLAYING",this._callback({playbackTime:t,count:this._count++});var e=this.$context,n=i.finite(e.toSeconds(this._schedTime));n=Math.max(1/e.sampleRate,n),e.sched(t+n,this._onsched,this)},e.exports=n},{"../util":54,"./sched":12}],14:[function(t,e){(function(n){"use strict";function i(t,e,n){n=n||{},this.$context=t.context,this.$destination=t,this._transport=new c.Transport(this),this.$analyser=this.$context.createAnalyser(),this.connect(this.$analyser,this.$destination),this._scriptProcessor=null,this._audioBuses=[],this._processBufSize=a.int(a.defaults(n.processBufSize,s.PROCESS_BUF_SIZE)),this.$inlet=null,this.$outlet=this.$analyser,Object.defineProperties(this,{context:{value:this,enumerable:!0},audioContext:{value:this.$context,enumerable:!0},sampleRate:{value:this.$context.sampleRate,enumerable:!0},currentTime:{get:function(){return this._currentTime||this.$context.currentTime},enumerable:!0},destination:{value:t,enumerable:!0},listener:{value:this.$context.listener,enumerable:!0},bpm:{get:function(){return this._transport.getBpm()},set:function(t){this._transport.setBpm(t)},enumerable:!0}}),this._duration=e,this.reset()}function o(){this._currentTimeIncr=a.clip(a.finite(this._duration),0,h),u.call(this,{playbackTime:0})}function r(){var t=this.$context,e=t.createScriptProcessor(this._processBufSize,1,1),n=t.createBufferSource();this._currentTimeIncr=this._processBufSize/t.sampleRate,this._scriptProcessor=e,e.onaudioprocess=u.bind(this),n.start(0),this.connect(n,e),this.connect(e,t.destination)}function u(t){var e=t.playbackTime||this.$context.currentTime,n=e+this._currentTimeIncr,i=this._events;for(this._currentTime=e,this._nextTicks.splice(0).forEach(function(t){t(e)});i.length&&i[0].time<=n;){var o=i.shift();this._currentTime=Math.max(this._currentTime,o.time),o.callback.call(o.context,o.time)}}var s=t("../const"),a=t("../util"),c=t("../namespace"),l=0,f=1,h=s.MAX_RENDERING_SEC,p=1;i.$name="NeuContext",Object.keys(n.AudioContext.prototype).forEach(function(t){var e=Object.getOwnPropertyDescriptor(n.AudioContext.prototype,t);if("function"==typeof e.value){var o=n.AudioContext.prototype[t];i.prototype[t]=function(){return o.apply(this.$context,arguments)}}}),i.prototype.createNeuComponent=function(t){return new c.Component(this,t)},i.prototype.createNeuDC=function(t){return new c.DC(this,a.finite(t))},i.prototype.createNeuMul=function(t,e){return new c.Mul(this,t,e)},i.prototype.createNeuSum=function(t){return new c.Sum(this,t)},i.prototype.createNeuParam=function(t,e){return new c.Param(this,a.finite(t),e)},i.prototype.createNeuDryWet=function(t,e,n){return new c.DryWet(this,t,e,n)},i.prototype.getAudioBus=function(t){return t=a.clip(a.int(a.defaults(t,0)),0,s.AUDIO_BUS_CHANNELS),this._audioBuses[t]||(this._audioBuses[t]=new c.AudioBus(this)),this._audioBuses[t]},i.prototype.reset=function(){return this.$inlet&&this.$inlet.disconnect(),this._audioBuses.splice(0).forEach(function(t){t.toAudioNode().disconnect()},this),this.$inlet=this._audioBuses[0]=this.getAudioBus(0),this.connect(this.$inlet,this.$analyser),this.disconnect(this._scriptProcessor),this._events=[],this._nextTicks=[],this._state=l,this._currentTime=0,this._scriptProcessor=null,this},i.prototype.start=function(){return this._state===l&&(this._state=f,this.$context instanceof n.OfflineAudioContext?o.call(this):r.call(this)),this},i.prototype.stop=function(){return this},i.prototype.sched=function(t,e,n){if(t=a.finite(t),!a.isFunction(e))return 0;var i=this._events,o={id:p++,time:t,callback:e,context:n||this};if(0===i.length||i[i.length-1].time<=t)i.push(o);else for(var r=0,u=i.length;u>r;r++)if(t<i[r].time){i.splice(r,0,o);break}return o.id},i.prototype.unsched=function(t){if(t=a.finite(t),0!==t)for(var e=this._events,n=0,i=e.length;i>n;n++)if(t===e[n].id){e.splice(n,1);break}return t},i.prototype.nextTick=function(t,e){return this._nextTicks.push(t.bind(e||this)),this},i.prototype.toAudioNode=function(t){return t&&t.toAudioNode?t=t.toAudioNode():"number"==typeof t&&(t=new c.DC(this,t).toAudioNode()),t instanceof n.AudioNode||(t=null),t},i.prototype.toAudioBuffer=function(t){return t&&t.toAudioBuffer?t.toAudioBuffer():(t instanceof n.AudioBuffer||(t=null),t)},i.prototype.connect=function(t,e){return e&&(Array.isArray(t)?t.length&&new c.Sum(this,t).connect(e):t instanceof c.Component||t instanceof c.UGen?t.connect(e):e instanceof n.AudioParam?"number"==typeof t?e.value=a.finite(t):(t=this.toAudioNode(t),t&&t.connect(e)):e instanceof n.AudioNode?(t=this.toAudioNode(t),t&&t.connect(e)):e instanceof c.AudioBus&&this.connect(t,e.toAudioNode()),e.onconnected&&e.onconnected(t)),this},i.prototype.disconnect=function(t){return t&&t.disconnect&&(t.disconnect(),t.$outputs&&t.$outputs.forEach(function(e){return e.ondisconnected&&e.ondisconnected(t)})),this},i.prototype.getBpm=function(){return this._transport.getBpm()},i.prototype.setBpm=function(t,e){return this._transport.setBpm(t,e),this},i.prototype.toSeconds=function(t){return this._transport.toSeconds(t)},i.prototype.toFrequency=function(t){return this._transport.toFrequency(t)},e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../const":8,"../namespace":22,"../util":54}],15:[function(t,e){"use strict";var n=t("../util"),i={},o={};e.exports={exists:function(t){return t=String(t),o.hasOwnProperty(t)},set:function(t,e){t=String(t),o.hasOwnProperty(t)&&delete i[t],o[t]=e},get:function(t){if(t=String(t),!i.hasOwnProperty(t)){if(!o.hasOwnProperty(t))throw new Error("key '"+t+"' is not registered.");i[t]="@"===t.charAt(0)&&"function"==typeof o[t]?o[t].apply(null,n.toArray(arguments).slice(1)):o[t],o[t]=null}return i[t]}}},{"../util":54}],16:[function(t,e){(function(n){"use strict";function i(t){function e(e){return new r.SynthDef(t,e)}return Object.defineProperties(e,{context:{value:t,enumerable:!0},audioContext:{value:t.audioContext,enumerable:!0},sampleRate:{value:t.sampleRate,enumerable:!0},destination:{value:t.$destination,enumerable:!0},currentTime:{get:function(){return t.currentTime},enumerable:!0},bpm:{get:function(){return t.bpm},set:function(e){t.bpm=e},enumerable:!0},toSeconds:{value:t.toSeconds.bind(t),enumerable:!0},toFrequency:{value:t.toFrequency.bind(t),enumerable:!0},Synth:{value:function(e){return new r.Synth(t,e,o.toArray(arguments).slice(1))},enumerable:!0},Buffer:{value:Object.defineProperties(function(e,n,i){return r.Buffer.create(t,e,n,i)},{from:{value:function(e){return r.Buffer.from(t,e)},enumerable:!0},load:{value:function(e){return r.Buffer.load(t,e)},enumerable:!0}}),enumerable:!0},Sched:{value:function(e){return new r.Sched(t,0,e)},enumerable:!0},Interval:{value:function(e,n){return new r.Interval(t,e,n)},enumerable:!0},Timeout:{value:function(e,n){return new r.Timeout(t,e,n)},enumerable:!0}}),e}t("./shim");var o=t("../util"),r=t("../namespace");r.impl=function(t,e){if(t instanceof n.AudioContext&&(t=t.destination),!(t instanceof n.AudioNode))throw new TypeError("neume(): Illegal arguments");var u=new r.Context(t,1/0,e);return Object.defineProperties(new i(u),{render:{value:function(t,e){var s=u.sampleRate,a=o.int(s*t);return new Promise(function(o){var c=new n.OfflineAudioContext(2,a,s);c.oncomplete=function(t){o(new r.Buffer(u,t.renderedBuffer))},e(new i(new r.Context(c.destination,t))),c.startRendering()})}},start:{value:function(){return u.start(),this},enumerable:!0},stop:{value:function(){return u.stop(),this},enumerable:!0},reset:{value:function(){return u.reset(),this},enumerable:!0},analyser:{value:u.$analyser,enumerable:!0}})},r.util=o,r.KVS=t("./kvs"),r.Context=t("./context"),r.Transport=t("./transport"),r.Component=t("../component/component"),r.DC=t("../component/dc"),r.DryWet=t("../component/drywet"),r.Mul=t("../component/mul"),r.Sum=t("../component/sum"),r.Param=t("../component/param"),r.AudioBus=t("../control/audio-bus"),r.Buffer=t("../control/buffer"),r.Sched=t("../control/sched"),r.Interval=t("../control/interval"),r.Timeout=t("../control/timeout"),r.FFT=t("../dsp/fft"),r.Emitter=t("../event/emitter"),r.SynthDB=t("../synth/db"),r.Synth=t("../synth/synth"),r.SynthDef=t("../synth/synthdef"),r.UGen=t("../synth/ugen"),r.Unit=t("../synth/unit"),function(t){Object.keys(t).forEach(function(e){r[e]=t[e]})}(t("../const")),r.register=function(t,e){return r.UGen.register(t,e),r},r.use=function(t){return-1===r.use.used.indexOf(t)&&(t(r,o),r.use.used.push(t)),r},r.use.used=[],e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../component/component":2,"../component/dc":3,"../component/drywet":4,"../component/mul":5,"../component/param":6,"../component/sum":7,"../const":8,"../control/audio-bus":9,"../control/buffer":10,"../control/interval":11,"../control/sched":12,"../control/timeout":13,"../dsp/fft":19,"../event/emitter":20,"../namespace":22,"../synth/db":24,"../synth/synth":26,"../synth/synthdef":27,"../synth/ugen":28,"../synth/unit":29,"../util":54,"./context":14,"./kvs":15,"./shim":17,"./transport":18}],17:[function(){(function(t){!function(){"use strict";t.AudioContext=t.AudioContext||t.webkitAudioContext,t.OfflineAudioContext=t.OfflineAudioContext||t.webkitOfflineAudioContext,"undefined"!=typeof t.AudioContext&&("function"!=typeof t.AudioContext.prototype.createGain&&(t.AudioContext.prototype.createGain=t.AudioContext.prototype.createGainNode),"function"!=typeof t.AudioContext.prototype.createDelay&&(t.AudioContext.prototype.createDelay=t.AudioContext.prototype.createDelayNode),"function"!=typeof t.AudioContext.prototype.createPeriodicWave&&(t.AudioContext.prototype.createPeriodicWave=t.AudioContext.prototype.createWaveTable),"function"!=typeof t.AudioBufferSourceNode.prototype.start&&(t.AudioBufferSourceNode.prototype.start=t.AudioBufferSourceNode.prototype.noteGrainOn),"function"!=typeof t.AudioBufferSourceNode.prototype.stop&&(t.AudioBufferSourceNode.prototype.stop=t.AudioBufferSourceNode.prototype.noteOff),"function"!=typeof t.OscillatorNode.prototype.start&&(t.OscillatorNode.prototype.start=t.OscillatorNode.prototype.noteOn),"function"!=typeof t.OscillatorNode.prototype.stop&&(t.OscillatorNode.prototype.stop=t.OscillatorNode.prototype.noteOff),"function"!=typeof t.OscillatorNode.prototype.setPeriodicWave&&(t.OscillatorNode.prototype.setPeriodicWave=t.OscillatorNode.prototype.setWaveTable),"undefined"==typeof t.PeriodicWave&&"undefined"!=typeof t.WaveTable&&(t.PeriodicWave=t.WaveTable,t.WaveTable.$name="PeriodicWave"))}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],18:[function(require,module,exports){"use strict";function NeuTransport(t){this.$context=t,this._bpm=120,this._ramp=null}function ticks2sec(t,e){return 60/e*(t/480)}function note2sec(t,e,n){var i={nt:2/3,nd:1.5}[e]||1;return 0===t?0:ticks2sec(4/t*480*i,n)}var util=require("../util");NeuTransport.$name="NeuTransport",NeuTransport.prototype.getBpm=function(){var t=this._ramp;if(null!==t){var e=this.$context.currentTime;if(t.t1<=e)this._bpm=t.v1,this._ramp=null;else{var n=(e-t.t0)/(t.t1-t.t0);this._bpm=t.v0*Math.pow(t.v1/t.v0,n)}}return this._bpm},NeuTransport.prototype.setBpm=function(t,e){e=this.toSeconds(util.defaults(e,0));var n=util.clip(util.finite(t),1,1e3);if(0>=e)this._bpm=n,this._ramp=null;else{var i=this.$context.currentTime;this._ramp={v0:this.getBpm(),t0:i,v1:n,t1:i+e}}return this},NeuTransport.prototype.toSeconds=function(value){if("number"==typeof value)return util.finite(value);if(value&&"object"==typeof value&&"number"==typeof value.playbackTime)return util.finite(value.playbackTime);if("string"==typeof value){var m,offset=0,time=0;"+"===value.charAt(0)&&(offset=this.$context.currentTime,value=value.slice(1));var components=value.split(/[\(\)\-\+\/\*]/);if(components.length>1){for(var oringalTime=value,expr=value,i=0,imax=components.length;imax>i;i++){var symb=components[i].trim();""!==symb&&(expr=expr.replace(symb,this.toSeconds(symb)))}try{time=eval(expr)}catch(e){throw new EvalError("Invalid Time Value Syntax: "+oringalTime)}}else if(null!==(m=/^(\d+)ms$/.exec(value)))time=.001*+m[1];else if(null!==(m=/^(\d+(?:\.\d+)?)hz$/.exec(value)))time=util.finite(1/+m[1]);else if(null!==(m=/^(\d+)ticks$/.exec(value)))time=ticks2sec(+m[1],this.getBpm());else if(null!==(m=/^(\d+)(n[td]?)$/.exec(value)))time=note2sec(+m[1],m[2],this.getBpm());else if(null!==(m=/^(\d+)\.(\d+)\.(\d+)$/.exec(value)))time=ticks2sec(480*(4*+m[1]+ +m[2])+ +m[3],this.getBpm());else if(null!==(m=/^(\d\d):(\d\d):(\d\d)(?:\.(\d+))?$/.exec(value)))time=3600*+m[1]+60*+m[2]+ +m[3]+.001*((m[4]||"")+"000").substr(0,3);else if(null!==(m=/^(\d+)samples$/.exec(value)))time=+m[1]/this.$context.sampleRate;
else{if("now"===value)return this.$context.currentTime;time=util.finite(+value)}return time+offset}return value},NeuTransport.prototype.toFrequency=function(t){return"number"==typeof t?util.finite(t):"string"==typeof t?util.finite(1/this.toSeconds(t)):t},module.exports=NeuTransport},{"../util":54}],19:[function(t,e){"use strict";function n(t){var e,n,i,o,s,a,c,l,f,h,p,d=1<<Math.ceil(Math.log(u.finite(t.length))*Math.LOG2E),m=new Float32Array(d),v=new Float32Array(d),y=new Float32Array(d),b=r(d),x=b.bitrev,g=b.sintable,_=b.costable;for(e=0;d>e;e++)m[e]=t[e],v[e]=t[x[e]],y[e]=0;for(i=1;d>i;i=o)for(s=0,o=i+i,a=d/o,n=0;i>n;n++){for(c=_[s],l=g[s],e=n;d>e;e+=o)f=e+i,h=l*y[f]+c*v[f],p=c*y[f]-l*v[f],v[f]=v[e]-h,y[f]=y[e]-p,v[e]+=h,y[e]+=p;s+=a}return{real:v,imag:y}}function i(t,e){var n,i,o,s,a,c,l,f,h,p,d,m=1<<Math.ceil(Math.log(u.finite(t.length))*Math.LOG2E),v=new Float32Array(m),y=new Float32Array(m),b=new Float32Array(m),x=r(m),g=x.bitrev,_=x.sintable,$=x.costable;for(n=0;m>n;n++)i=g[n],y[n]=+t[i],b[n]=-e[i];for(o=1;m>o;o=s)for(a=0,s=o+o,c=m/s,i=0;o>i;i++){for(l=$[a],f=_[a],n=i;m>n;n+=s)h=n+o,p=f*b[h]+l*y[h],d=l*b[h]-f*y[h],y[h]=y[n]-p,b[h]=b[n]-d,y[n]+=p,b[n]+=d;a+=c}for(n=0;m>n;n++)v[n]=y[n]/m;return v}function o(t){for(var e=new Int16Array(t),n=t>>1,i=0,o=0;;){if(e[i]=o,++i>=t)break;for(var r=n;o>=r;)o-=r,r>>=1;o+=r}return e}function r(t){if(r.cache[t])return r.cache[t];for(var e=o(t),n=Math.floor(Math.log(t)/Math.LN2),i=new Float32Array((1<<n)-1),u=new Float32Array((1<<n)-1),s=0,a=i.length;a>s;s++)i[s]=Math.sin(2*Math.PI*(s/t)),u[s]=Math.cos(2*Math.PI*(s/t));return r.cache[t]={bitrev:e,sintable:i,costable:u},r.cache[t]}var u=t("../util");r.cache=[],e.exports={forward:n,inverse:i}},{"../util":54}],20:[function(t,e){"use strict";function n(){this._callbacks={}}n.prototype.hasListeners=function(t){return this._callbacks.hasOwnProperty(t)},n.prototype.listeners=function(t){return this.hasListeners(t)?this._callbacks[t].slice():[]},n.prototype.on=function(t,e){return this.hasListeners(t)||(this._callbacks[t]=[]),this._callbacks[t].push(e),this},n.prototype.once=function(t,e){function n(i){this.off(t,n),e.call(this,i)}return n.listener=e,this.on(t,n),this},n.prototype.off=function(t,e){return"undefined"==typeof e?"undefined"==typeof t?this._callbacks={}:this.hasListeners(t)&&delete this._callbacks[t]:this.hasListeners(t)&&(this._callbacks[t]=this._callbacks[t].filter(function(t){return!(t===e||t.listener===e)})),this},n.prototype.emit=function(t,e,n){this.listeners(t).forEach(function(t){t.call(this,e)},n||this)},e.exports=n},{}],21:[function(t,e){e.exports=t("./core/neume")},{"./core/neume":16}],22:[function(t,e){"use strict";function n(){return n.impl.apply(null,arguments)}n.version="0.4.0",e.exports=n},{}],23:[function(t,e){"use strict";function n(t){var e=o.exec(t);return!!e&&e[0]===t}function i(t){t=String(t);var e={key:"",id:null,"class":[]},n=t.match(o);n&&(e.key=n[0],t=t.substr(e.key.length));var i=t.match(/[.#][a-zA-Z](-?[a-zA-Z0-9]+)*/g);return i&&i.forEach(function(t){var n=t.charAt(0);"#"===n?e.id||(e.id=t.substr(1)):e.class.push(t.substr(1))}),e}var o=/^([a-zA-Z](-?[a-zA-Z0-9]+)*!?\??~?|[-+*\/%<=>!?&|@]+~?)/;e.exports={isValidUGenName:n,parse:i}},{}],24:[function(t,e){"use strict";function n(){this._all=[],this._ids={}}var i=t("../util"),o=t("../parser/selector");n.prototype.append=function(t){return i.isObject(t)&&(this._all.push(t),t.hasOwnProperty("$id")&&(this._ids[t.$id]=t)),this},n.$name="NeuSynthDB",n.prototype.all=function(){return this._all},n.prototype.find=function(t){var e=null,n=o.parse(t);return e=n.id?this._ids[n.id]?[this._ids[n.id]]:[]:this._all,n.class.forEach(function(t){e=e.filter(function(e){return-1!==e.$class.indexOf(t)})}),n.key&&(e=e.filter(function(t){return t.$key===n.key})),e},e.exports=n},{"../parser/selector":23,"../util":54}],25:[function(t,e){"use strict";function n(t){function e(){var e=c.toArray(arguments),i=e.shift(),o=c.isDictionary(e[0])?e.shift():{},r=Array.prototype.concat.apply([],e),u=h.build(t,i,o,r);return n.append(u),u}var n=new f;this.db=n,this.params={},this.methods={},this.timers=[],e.param=i(t,this.params),e.method=o(t,this.methods),e.timeout=r(t,this.timers),e.interval=u(t,this.timers),e.stop=s(t),this.builder=e}function i(t,e){return function(n,i){if(e.hasOwnProperty(n))return e[n];i=c.finite(c.defaults(i,0)),a(n,i);var o=new l(t.$context,i);return Object.defineProperty(t,n,{value:o,enumerable:!0}),e[n]=o,o}}function o(t,e){return function(t,n){/^[a-z]\w*$/.test(t)&&"function"==typeof n&&(e[t]=n)}}function r(t,e){var n=t.$context;return function(i){function o(e){r=n.sched(e,function(e){r=0;for(var n=0,i=u.length;i>n;n++)u[n].call(t,{playbackTime:e,count:1})})}i=Math.max(0,c.finite(n.toSeconds(i)));var r=0,u=c.toArray(arguments).slice(1).filter(c.isFunction);e.push({start:function(t){o(t+i)},stop:function(){n.unsched(r),r=0}})}}function u(t,e){var n=t.$context,i=1/n.sampleRate;return function(o){function r(e){s=n.sched(e,function(e){s=0,f+=1;for(var h=0,p=a.length;p>h;h++)a[h].call(t,{playbackTime:e,count:f});var d=u?e+Math.max(i,c.finite(n.toSeconds(o))):l+o*(f+1);r(d)})}var u;/\d+(ticks|n)|\d+\.\d+\.\d+/.test(o)?u=!0:(u=!1,o=Math.max(i,c.finite(n.toSeconds(o))));var s=0,a=c.toArray(arguments).slice(1).filter(c.isFunction),l=0,f=0;e.push({start:function(t){l=t;var e=u?l+Math.max(i,c.finite(n.toSeconds(o))):l+o;r(e)},stop:function(){n.unsched(s),s=0}})}}function s(t){var e=t.$context;return function(n){e.sched(e.toSeconds(n),function(e){t.stop(e)})}}function a(t){if(!/^[a-z]\w*$/.test(t))throw new TypeError(c.format("invalid parameter name: #{name}",{name:t}))}var c=t("../util"),l=t("../component/param"),f=t("./db"),h=t("./ugen");e.exports=n},{"../component/param":6,"../util":54,"./db":24,"./ugen":28}],26:[function(t,e){"use strict";function n(t,e,n){this.$context=t,this.$routes=[],this.$localBuses=[];var i=new c(this);this.$builder=i.builder;var o=new s.Param(t,1,{curve:"lin"}),r=e.apply(null,[i.builder].concat(n));r&&r.toAudioNode&&!r.$isOutput&&(this.$routes[0]=r),this.$routes=this.$routes.map(function(e){var n=t.createGain();return t.connect(e,n),t.connect(o,n.gain),n}),this._connected=!1,this._db=this.$routes.length?i.db:l,this._state=f,this._stateString="UNSCHEDULED",this._timers=i.timers,this._param=o;var a=[];Object.keys(i.methods).forEach(function(t){var e=i.methods[t];a.push(t),Object.defineProperty(this,t,{value:function(){return e.apply(this,u.toArray(arguments)),this}})},this),this._db.all().forEach(function(t){Object.keys(t.$unit.$methods).forEach(function(t){this.hasOwnProperty(t)||(a.push(t),Object.defineProperty(this,t,{value:function(e,n){var i;return i=null!=e&&"object"!=typeof e?{playbackTime:e,value:n}:e||{},this.call(t,i),this}}))},this)},this),Object.defineProperties(this,{context:{value:this.$context,enumerable:!0},currentTime:{get:function(){return this.$context.currentTime},enumerable:!0},state:{get:function(){return this._stateString},enumerable:!0},methods:{value:a.sort(),enumerable:!0}})}function i(t,e){return e?t.find(e):t.all()}function o(t,e,n){var o=r(e);o&&i(t,o.selector).forEach(function(t){n(t,o.name)})}function r(t){var e=/^(?:(.*?):([a-z]\w+)|([a-z]\w+))$/.exec(t);return e?null!=e[3]?{selector:null,name:e[3]}:{selector:e[1],name:e[2]}:null}var u=t("../util"),s=t("../namespace"),a=t("./db"),c=t("./dollar"),l=new a,f=0,h=1,p=2;n.$name="NeuSynth",n.prototype.find=function(t){return this._db.find(t)},n.prototype.start=function(t){var e=this.$context;return t=u.defaults(e.toSeconds(t),e.currentTime),t=u.finite(t),this._state===f&&(this._state=h,this._stateString="SCHEDULED",e.sched(t,function(){this._stateString="PLAYING"},this),this.$routes.forEach(function(t,e){this.connect(t,this.getAudioBus(e))},e),this._db.all().forEach(function(e){e.$unit.start(t)}),this._timers.forEach(function(e){e.start(t)}),e.start()),this},n.prototype.stop=function(t){var e=this.$context;return t=u.defaults(e.toSeconds(t),e.currentTime),t=u.finite(t),this._state===h&&(this._state=p,e.sched(t,function(t){this._stateString="FINISHED",e.nextTick(function(){this.$routes.forEach(function(t){e.disconnect(t)})},this),this._db.all().forEach(function(e){e.$unit.stop(t)}),this._timers.forEach(function(e){e.stop(t)})},this)),this},n.prototype.fadeIn=function(t,e){var n=this.$context;return t=u.defaults(n.toSeconds(t),n.currentTime),e=u.defaults(n.toSeconds(e),.5),t=u.finite(t),e=u.finite(e),this._state===f&&(this.$routes.length&&(this._param.value=0,n.sched(t,function(t){this._param.update(1,t,e)},this)),this.start(t)),this},n.prototype.fadeOut=function(t,e){var n=this.$context;return t=u.defaults(n.toSeconds(t),n.currentTime),e=u.defaults(n.toSeconds(e),.5),t=u.finite(t),e=u.finite(e),this._state===h&&(this.$routes.length&&n.sched(t,function(t){this._param.update(0,t,e)},this),this.stop(t+e)),this},n.prototype.fade=function(t,e,n){var i=this.$context;return t=u.defaults(i.toSeconds(t),i.currentTime),n=u.defaults(i.toSeconds(n),.5),t=u.finite(t),e=u.finite(e),n=u.finite(n),this._state===h&&this.$routes.length&&i.sched(t,function(t){this._param.update(e,t,n)},this),this},n.prototype.apply=function(t,e){return o(this._db,t,function(t,n){t.$unit.apply(n,e)}),this},n.prototype.call=function(){var t=u.toArray(arguments),e=t.shift();return this.apply(e,t)},n.prototype.toAudioNode=function(){return this.$context.toAudioNode(this.$routes[0])},n.prototype.hasListeners=function(t){var e=!1;return o(this._db,t,function(t,n){e=e||t.hasListeners(n)}),e},n.prototype.listeners=function(t){var e=[];return o(this._db,t,function(t,n){t.listeners(n).forEach(function(t){-1===e.indexOf(t)&&e.push(t)})}),e},n.prototype.on=function(t,e){return o(this._db,t,function(t,n){t.on(n,e)}),this},n.prototype.once=function(t,e){return o(this._db,t,function(t,n){t.once(n,e)}),this},n.prototype.off=function(t,e){return o(this._db,t,function(t,n){t.off(n,e)}),this},e.exports=n},{"../namespace":22,"../util":54,"./db":24,"./dollar":25}],27:[function(t,e){(function(n){"use strict";function i(t,e){function i(){var i=t,u=o.toArray(arguments);return u[0]instanceof n.AudioContext&&(i=u.shift()),new r.Synth(i,e,u)}if(!o.isFunction(e))throw new TypeError("NeuSynthDef func is not a function");return Object.defineProperties(i,{context:{value:t,enumerable:!0}}),i}var o=t("../util"),r=t("../namespace");e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../namespace":22,"../util":54}],28:[function(t,e){"use strict";function n(t,e,u,c){s.call(this);var l=a.parse(e);if(!n.registered.hasOwnProperty(l.key))throw new Error("unknown key: "+e);this.$context=t.$context,this.$synth=t,this.$key=l.key,this.$class=l.class,this.$id=l.id,this.$outlet=null,this.$builder=t.$builder;var f=n.registered[l.key](this,u,c);this._node=f.$outlet,this._node=i(this.$context,this._node,r.defaults(u.mul,1)),this._node=o(this.$context,this._node,r.defaults(u.add,0)),this.$isOutput=f.$isOutput,this.$unit=f,Object.keys(f.$methods).forEach(function(t){var e=f.$methods[t];r.definePropertyIfNotExists(this,t,{value:function(t,n){var i;return i=null!=t&&"object"!=typeof t?{playbackTime:t,value:n}:t||{},e.call(this,i),this}})},this)}function i(t,e,n){if(1===n)return e;if(0===n)return new u.DC(t,0);var i=t.createGain();return i.gain.value=0,t.connect(e,i),t.connect(n,i.gain),i}function o(t,e,n){return new u.Sum(t,[e,n])}var r=t("../util"),u=t("../namespace"),s=t("../event/emitter"),a=t("../parser/selector");r.inherits(n,s),n.$name="NeuUGen",n.registered={},n.register=function(t,e){if(!a.isValidUGenName(t))throw new Error("invalid ugen name: "+t);if("function"!=typeof e)throw new TypeError("ugen must be a function");n.registered[t]=e},n.build=function(t,e,i,o){if("string"!=typeof e){var u=r.typeOf(e);"object"!=typeof e||n.registered.hasOwnProperty(u)||(u="object"),i.value=e,e=u}return new n(t,e,i,o)},n.prototype.$=function(){var t=r.toArray(arguments),e=t.shift(),n=r.isDictionary(t[0])?t.shift():{},i=Array.prototype.concat.apply([this],t);return this.$builder(e,n,i)},n.prototype.mul=function(t){return this.$builder("*",this,r.defaults(t,1))},n.prototype.add=function(t){return this.$builder("+",this,r.defaults(t,0))},n.prototype.toAudioNode=function(){return null===this.$outlet&&(this.$outlet=this.$context.toAudioNode(this._node)),this.$outlet},n.prototype.connect=function(t){return this._node.connect(t),this},n.prototype.disconnect=function(){return this._node.disconnect(),this},e.exports=n},{"../event/emitter":20,"../namespace":22,"../parser/selector":23,"../util":54}],29:[function(t,e){"use strict";function n(t){this._spec=t,this._state=o,this.$outlet=i.defaults(t.outlet,null),this.$methods=i.defaults(t.methods,{}),this.$isOutput=!!t.isOutput}var i=t("../util"),o=0,r=1,u=2;n.$name="NeuUnit",n.prototype.start=function(t){this._state===o&&i.isFunction(this._spec.start)&&(this._state=r,this._spec.start(i.finite(t)))},n.prototype.stop=function(t){this._state===r&&i.isFunction(this._spec.stop)&&(this._state=u,this._spec.stop(i.finite(t)))},n.prototype.apply=function(t,e){this.$methods[t]&&this.$methods[t].apply(null,e)},n.prototype.toAudioNode=function(){return this.$outlet},e.exports=n},{"../util":54}],30:[function(t,e){e.exports=function(t){"use strict";function e(e,n,i){return new t.Unit({outlet:new t.Sum(e.$context,i)})}t.register("+",function(t,n,i){return e(t,n,i)})}},{}],31:[function(t,e){e.exports=function(t,e){"use strict";function n(n,i,o){function r(t){var n=e.finite(l.toSeconds(t.playbackTime)),i=t.value;Array.isArray(i)&&l.sched(e.finite(n),function(){h=i})}function u(t){var n=e.finite(l.toSeconds(t.playbackTime)),i=e.defaults(t.value,t.index,t.count);l.sched(n,function(t){c(e.int(i),t)})}function s(t){var n=e.finite(l.toSeconds(t.playbackTime));l.sched(n,function(t){c(f+1,t)})}function a(t){var n=e.finite(l.toSeconds(t.playbackTime));l.sched(n,function(t){c(f-1,t)})}function c(t,e){var n=p(h,t);d.update(n,e),f=t}var l=n.$context,f=0,h=i.value,p={clip:e.clipAt,wrap:e.wrapAt,fold:e.foldAt}[i.clip||i.mode]||e.clipAt;Array.isArray(h)&&0!==h.length||(h=[0]);var d=new t.Param(l,e.finite(h[0]),i),m=o.length?d.toAudioNode(o):d;return new t.Unit({outlet:m,methods:{setValue:r,at:u,next:s,prev:a}})}t.register("array",function(t,e,i){return n(t,e,i)})}},{}],32:[function(t,e){(function(t){e.exports=function(e){"use strict";function n(n,i,o){var r=n.$context,u=i.value;return Object.keys(i).forEach(function(e){"undefined"!=typeof u[e]&&(u[e]instanceof t.AudioParam?r.connect(i[e],u[e]):u[e]=i[e])}),u.numberOfInputs&&r.connect(o,u),new e.Unit({outlet:u})}["AudioBufferSourceNode","MediaElementAudioSourceNode","MediaStreamAudioSourceNode","ScriptProcessorNode","GainNode","BiquadFilterNode","DelayNode","PannerNode","ConvolverNode","AnalyserNode","DynamicsCompressorNode","WaveShaperNode","OscillatorNode"].forEach(function(t){e.register(t,function(t,e,i){return n(t,e,i)})})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],33:[function(t,e){e.exports=function(t,e){"use strict";function n(n,i,o,r){var u=i.$context,s=u.createBiquadFilter();s.type=n,s.frequency.value=0,s.detune.value=0,s.Q.value=0,s.gain.value=0;var a=u.toFrequency(e.defaults(o.freq,o.frequency,350)),c=e.defaults(o.dt,o.detune,0),l=e.defaults(o.Q,1),f=e.defaults(o.gain,0);return u.connect(a,s.frequency),u.connect(c,s.detune),u.connect(l,s.Q),u.connect(f,s.gain),u.connect(r,s),new t.Unit({outlet:s})}var i={lowpass:"lowpass",highpass:"highpass",bandpass:"bandpass",lowshelf:"lowshelf",highshelf:"highshelf",peaking:"peaking",notch:"notch",allpass:"allpass",lpf:"lowpass",hpf:"highpass",bpf:"bandpass"};t.register("biquad",function(t,e,o){var r=i[e.type]||"lowpass";return n(r,t,e,o)}),Object.keys(i).forEach(function(e){var o=i[e];t.register(e,function(t,e,i){return n(o,t,e,i)})})}},{}],34:[function(t,e){e.exports=function(t,e){"use strict";function n(n,i,o){function r(t){var n=e.finite(a.toSeconds(t.playbackTime)),i=t.value;"boolean"==typeof i&&a.sched(n,function(t){s(i?l:f,t,i)})}function u(t){var n=e.finite(a.toSeconds(t.playbackTime));a.sched(n,function(t){s(c?f:l,t,!c)})}function s(t,e,n){h.update(t,e),c=n}var a=n.$context,c=!!i.value,l=e.finite(e.defaults(i.true,1)),f=e.finite(e.defaults(i.false,0)),h=new t.Param(a,c?l:f,i),p=o.length?h.toAudioNode(o):h;return new t.Unit({outlet:p,methods:{setValue:r,toggle:u}})}t.register("boolean",function(t,e,i){return n(t,e,i)})}},{}],35:[function(t,e){e.exports=function(t,e){"use strict";function n(n,i,o){function r(t){null!=l?a.start(t,c,l):a.start(t,c),a.onended=function(){i.emit("end",{playbackTime:s.currentTime},i.$synth)}}function u(t){a.stop(t)}var s=i.$context,a=s.createBufferSource();n=s.toAudioBuffer(n),null!=n&&(a.buffer=n),a.loop=!!e.defaults(o.loop,!1),a.loopStart=e.finite(e.defaults(o.start,o.loopStart,0)),a.loopEnd=e.finite(e.defaults(o.end,o.loopEnd,0)),a.playbackRate.value=0,s.connect(e.defaults(o.rate,o.playbackRate,1),a.playbackRate);var c=e.finite(e.defaults(o.offset,0)),l=s.toSeconds(e.defaults(o.dur,o.duration,null));return null!=l&&(l=e.finite(l)),new t.Unit({outlet:a,start:r,stop:u})}t.register("buf",function(t,e){return n(e.buf||e.buffer,t,e)}),t.register("AudioBuffer",function(t,e){return n(e.value,t,e)}),t.register("NeuBuffer",function(t,e){return n(e.value,t,e)})}},{}],36:[function(t,e){e.exports=function(t,e){"use strict";function n(n,i,o){var r=n.$context,u=r.createDynamicsCompressor();u.threshold.value=0,u.knee.value=0,u.ratio.value=0,u.attack.value=0,u.release.value=0;var s=e.defaults(i.thresh,i.threshold,-24),a=e.defaults(i.knee,30),c=e.defaults(i.ratio,12),l=r.toSeconds(e.defaults(i.a,i.attack,.003)),f=r.toSeconds(e.defaults(i.r,i.release,.25));return r.connect(s,u.threshold),r.connect(a,u.knee),r.connect(c,u.ratio),r.connect(l,u.attack),r.connect(f,u.release),r.connect(o,u),new t.Unit({outlet:u})}t.register("comp",function(t,e,i){return n(t,e,i)})}},{}],37:[function(t,e){e.exports=function(t,e){"use strict";function n(n,i,o){var r=n.$context,u=r.createConvolver(),s=r.toAudioBuffer(i.buf||i.buffer);return null!=s&&(u.buffer=s),u.normalize=!!e.defaults(i.normalize,!0),r.connect(o,u),new t.Unit({outlet:u})}t.register("conv",function(t,e,i){return n(t,e,i)})}},{}],38:[function(t,e){e.exports=function(t,e){"use strict";function n(n,o,r){var u,s=n.$context,a=s.toSeconds(e.defaults(o.delay,o.delayTime,0)),c=e.defaults(o.fb,o.feedback,0);"number"==typeof a?(a=e.clip(e.finite(a),0,i),u=a):u=e.finite(s.toSeconds(e.defaults(o.maxDelay,o.maxDelayTime,1))),u=e.clip(u,1/s.sampleRate,i);var l=s.createDelay(u);if(l.delayTime.value=0,s.connect(a,l.delayTime),0!==c){var f=s.createGain();f.gain.value=0,s.connect(l,f),s.connect(c,f.gain),r=r.concat(f)}return s.connect(r,l),new t.Unit({outlet:l})}var i=t.MAX_DELAY_SEC;t.register("delay",function(t,e,i){return n(t,e,i)})}},{}],39:[function(t,e){e.exports=function(t,e){"use strict";function n(t,n){for(var i=[],o={init:e.finite(t.shift()),list:i,releaseNode:-1,loopNode:-1,index:0,length:0},r=0,u=t.length;u>r;){var s=t[r++];"number"==typeof s?i.push([n(e.clip(e.finite(s),0,1)),t[r++]]):(/^(>|r(elease)?)$/i.test(s)&&(o.releaseNode=i.length),/^(<|l(oop)?)$/i.test(s)&&(o.loopNode=i.length))}return o.length=i.length,o}function i(e,n,i){var r,u=null;return"number"==typeof i&&(t.KVS.exists(s+i)||t.KVS.set(s+i,o(i))),t.KVS.exists(s+i)&&(u=t.KVS.get(s+i)),null!=u&&(r=e.createWaveShaper(),r.curve=u,e.connect(n,r),n=r),n}function o(t){for(var e=new Float32Array(4096),n=Math.exp(t),i=1/(1-n),o=0;2048>o;o++){var r=o/2048;e[o+2048]=i-i*Math.pow(n,r)}return e}function r(t){return"number"==typeof t?function(e){var n=1/(1-Math.exp(t));return Math.log((n-e)/n)/t}:a[t]||a.identity}function u(o,u,s,a){function c(t){x.index=0,g.setValueAtTime(x.init,t),0!==x.releaseNode&&(v=d.sched(t,h))}function l(t){p(t),g.setValueAtTime(g.valueAtTime(t),t),d.unsched(v),d.unsched(y),v=0,x.index=x.length,$=!0}function f(t){if(!$&&!y&&-1!==x.releaseNode){var n=e.finite(d.toSeconds(t.playbackTime));y=d.sched(n,function(t){d.unsched(v),v=0,x.index=x.releaseNode,_=!0,p(t),h(t)})}}function h(t){var n=x.list[x.index];if(null!=n){x.index+=1;var i=e.finite(d.toSeconds(n[1])),o=t+i,r=g.valueAtTime(t),s=e.finite(n[0]);switch(m){case"step":g.setValueAtTime(s,t);break;case"hold":g.setValueAtTime(r,t),g.setValueAtTime(s,o);break;case"exp":case"exponential":g.setValueAtTime(Math.max(1e-6,r),t),g.exponentialRampToValueAtTime(Math.max(1e-6,s),o),b={method:"exponentialRampToValueAtTime",time:o};break;default:g.setValueAtTime(r,t),g.linearRampToValueAtTime(s,o),b={method:"linearRampToValueAtTime",time:o}}_||-1===x.loopNode||(x.index===x.releaseNode||x.index===x.length)&&(x.index=x.loopNode),v=0,x.index===x.length?v=d.sched(o,function(t){v=0,u.emit("end",{playbackTime:t},u.$synth)}):x.index!==x.releaseNode&&(v=d.sched(o,h))}}function p(t){if(!(null==b||b.time<=t)){var e=g.valueAtTime(t);g.cancelScheduledValues(b.time),g[b.method](e,t)}}var d=u.$context,m=e.defaults(s.curve,"lin");"number"==typeof m&&(m=e.finite(m),Math.abs(m)<.001&&(m="lin"));var v,y,b,x=n(o,r(m)),g=new t.Param(d,x.init),_=!1,$=!1,A=a.length?g.toAudioNode(a):g;return A=i(d,A,m),new t.Unit({outlet:A,start:c,stop:l,methods:{release:f}})}var s="@neume:env:";t.register("env",function(t,n,i){return u(e.toArray(n.table),t,n,i)}),t.register("adsr",function(t,n,i){var o=e.defaults(n.a,n.attackTime,.01),r=e.defaults(n.d,n.decayTime,.3),s=e.defaults(n.s,n.sustainLevel,.5),a=e.defaults(n.r,n.releaseTime,1);return u([0,1,o,s,r,">",0,a],t,n,i)}),t.register("dadsr",function(t,n,i){var o=e.defaults(n.delay,n.delayTime,.1),r=e.defaults(n.a,n.attackTime,.01),s=e.defaults(n.d,n.decayTime,.3),a=e.defaults(n.s,n.sustainLevel,.5),c=e.defaults(n.r,n.releaseTime,1);return u([0,0,o,1,r,a,s,">",0,c],t,n,i)}),t.register("asr",function(t,n,i){var o=e.defaults(n.a,n.attackTime,.01),r=e.defaults(n.s,n.sustainLevel,1),s=e.defaults(n.r,n.releaseTime,1);return u([0,r,o,">",0,s],t,n,i)}),t.register("cutoff",function(t,n,i){var o=e.defaults(n.r,n.releaseTime,.1);return u([1,">",0,o],t,n,i)}),t.KVS.set(s+"sine",function(){for(var t=new Float32Array(4096),e=0;2048>e;e++){var n=e/2048;t[e+2048]=n-.15*Math.sin(2*n*Math.PI)}return t}),t.KVS.set(s+"welch",function(){for(var t=new Float32Array(4096),e=0;2048>e;e++){var n=e/2048;t[e+2048]=Math.sin(.5*n*Math.PI)}return t}),t.KVS.set(s+"squared",function(){for(var t=new Float32Array(4096),e=0;2048>e;e++){var n=e/2048;t[e+2048]=n*n}return t}),t.KVS.set(s+"cubic",function(){for(var t=new Float32Array(4096),e=0;2048>e;e++){var n=e/2048;t[e+2048]=n*n*n}return t});var a={sine:function(t){var e,n,i=1,o=0;if(0===t)return 0;if(1===t)return 1;for(;;){if(e=.5*(i+o),n=e-.15*Math.sin(2*e*Math.PI),Math.abs(t-n)<1e-6)break;t>n?o=e:i=e}return e},welch:function(t){return 2*Math.asin(t)/Math.PI},squared:function(t){return Math.pow(t,.5)},cubic:function(t){return Math.pow(t,1/3)},identity:function(t){return t}}}},{}],40:[function(t,e){e.exports=function(t,e){"use strict";function n(n,o,r){function u(t){var n=e.finite(c.toSeconds(t.playbackTime)),i=t.value;"function"==typeof i&&c.sched(n,function(){l=i})}function s(t){var n=e.finite(c.toSeconds(t.playbackTime));c.sched(n,function(t){a(t)})}function a(t){var e=l({playbackTime:t,count:f++});h.update(e,t)}var c=n.$context,l="function"==typeof o.value?o.value:i,f=0,h=new t.Param(c,e.finite(l(0,f++)),o),p=r.length?h.toAudioNode(r):h;return new t.Unit({outlet:p,methods:{setValue:u,evaluate:s}})}var i=function(){};t.register("function",function(t,e,i){return n(t,e,i)})}},{}],41:[function(t,e){e.exports=function(e){"use strict";e.use(t("./add")),e.use(t("./array")),e.use(t("./audio-node")),e.use(t("./biquad")),e.use(t("./boolean")),e.use(t("./buf")),e.use(t("./comp")),e.use(t("./conv")),e.use(t("./delay")),e.use(t("./env")),e.use(t("./function")),e.use(t("./inout")),e.use(t("./iter")),e.use(t("./lfpulse")),e.use(t("./line")),e.use(t("./mono")),e.use(t("./mul")),e.use(t("./noise")),e.use(t("./number")),e.use(t("./object")),e.use(t("./osc")),e.use(t("./pan2")),e.use(t("./shaper"))}},{"./add":30,"./array":31,"./audio-node":32,"./biquad":33,"./boolean":34,"./buf":35,"./comp":36,"./conv":37,"./delay":38,"./env":39,"./function":40,"./inout":42,"./iter":43,"./lfpulse":44,"./line":45,"./mono":46,"./mul":47,"./noise":48,"./number":49,"./object":50,"./osc":51,"./pan2":52,"./shaper":53}],42:[function(t,e){e.exports=function(t,e){"use strict";function n(t,n){return n=e.clip(e.int(e.defaults(n,0)),0,o),t.getAudioBus(n)}function i(t,n,i){return i=e.clip(e.int(e.defaults(i,0)),0,o),n.$localBuses[i]||(n.$localBuses[i]=t.createGain()),n.$localBuses[i]}var o=t.AUDIO_BUS_CHANNELS;t.register("in",function(i,o,r){var u=i.$context,s=null;return r=r.filter(e.isFinite).map(function(t){return n(u,t)}),s=new t.Sum(u,r),new t.Unit({outlet:s})}),t.register("out",function(n,i,r){var u=n.$context,s=n.$synth,a=new t.Sum(u,r),c=e.clip(e.int(e.defaults(i.bus,0)),0,o);return s.$routes[c]=a,new t.Unit({outlet:a,isOutput:!0})}),t.register("local-in",function(n,o,r){var u=n.$context,s=n.$synth,a=null;return r=r.filter(e.isFinite).map(function(t){return i(u,s,t)}),a=new t.Sum(u,r),new t.Unit({outlet:a})}),t.register("local-out",function(n,r,u){var s=n.$context,a=n.$synth,c=null,l=e.clip(e.int(e.defaults(r.bus,0)),0,o),f=i(s,a,l);return c=new t.Sum(s,u).connect(f),new t.Unit({outlet:c})})}},{}],43:[function(t,e){e.exports=function(t,e){"use strict";function n(n,r,u){function s(t){var i=l();i.done?(p=o,n.emit("end",{playbackTime:t},n.$synth)):d.setValueAtTime(e.finite(i.value),t)}function a(t){var n=e.finite(f.toSeconds(t.playbackTime)),i=t.value;"object"==typeof i&&"function"==typeof i.next&&f.sched(n,function(){h=i})}function c(t){var r=e.finite(f.toSeconds(t.playbackTime));f.sched(r,function(t){if(p===i){var r=l();r.done?(p=o,n.emit("end",{playbackTime:t},n.$synth)):d.update(e.finite(r.value),t)}})}function l(){if(null==h)return{value:void 0,done:!0};var t;return"function"==typeof h.next?(t=h.next(),e.isObject(t)||(t={value:t,done:!1})):t={value:h.valueOf(),done:!1},t}var f=n.$context,h=e.defaults(r.iter,null),p=i,d=new t.Param(f,0,r),m=u.length?d.toAudioNode(u):d;return new t.Unit({outlet:m,start:s,methods:{setValue:a,next:c}})}var i=0,o=1;t.register("iter",function(t,e,i){return n(t,e,i)})}},{}],44:[function(t,e){e.exports=function(t,e){"use strict";function n(e,n,r){var u=r.length?o(e,n,r):i(e,n),s=u.outlet,a=u.ctrl;return new t.Unit({outlet:s,start:function(t){a.start(t)},stop:function(t){a.stop(t)}})}function i(t,e){var n=r(t.$context,e,440);return{outlet:n.outlet,ctrl:n.ctrl}}function o(t,e,n){var i=t.$context,o=r(i,e,2),u=t.$context.createGain();return u.gain.value=0,i.connect(o.outlet,u.gain),i.connect(n,u),{outlet:u,ctrl:o.ctrl}}function r(n,i,o){var r,l=e.defaults(i.width,i.duty,.5),f=u(n,i,o),h=s(n,t.KVS.get(c+"ws-curve"));return"number"==typeof l?r=-2*l:(r=a(n,-2),n.connect(l,r)),n.connect([f,1,r],h),{outlet:h,ctrl:f}}function u(n,i,o){var r=n.createOscillator();r.setPeriodicWave(t.KVS.get(c+"src",n)),r.frequency.value=0,r.detune.value=0;var u=n.toFrequency(e.defaults(i.freq,i.frequency,o)),s=e.defaults(i.dt,i.detune,0);return n.connect(u,r.frequency),n.connect(s,r.detune),r}function s(t,e){var n=t.createWaveShaper();return n.curve=e,n}function a(t,e){var n=t.createGain();return n.gain.value=e,n}var c="@neume:lfpulse:";t.register("lfpulse",function(t,e,i){return n(t,e,i)}),t.KVS.set(c+"src",function(t){for(var e=new Float32Array(4096),n=new Float32Array(4096),i=1;4096>i;i++)n[i]=1/i,i%2===0&&(n[i]*=-1);return t.createPeriodicWave(e,n)}),t.KVS.set(c+"ws-curve",function(){for(var t=new Float32Array(4096),e=0;2048>e;e++)t[e]=-1,t[e+2048]=1;return t})}},{}],45:[function(t,e){e.exports=function(t,e){"use strict";function n(e,n,i,o,r,u){function s(t){var u=t,s=u+r;f.setAt(i,u),f[e](o,s),l=c.sched(s,function(t){l=0,n.emit("end",{playbackTime:t},n.$synth)})}function a(){c.unsched(l)}var c=n.$context,l=0,f=new t.Param(c,i),h=u.length?f.toAudioNode(u):f;return new t.Unit({outlet:h,start:s,stop:a})}t.register("line",function(t,i,o){var r=e.finite(e.defaults(i.start,i.startValue,1)),u=e.finite(e.defaults(i.end,i.endValue,0)),s=e.finite(e.defaults(t.$context.toSeconds(i.dur,i.duration),1));return n("linTo",t,r,u,s,o)}),t.register("xline",function(t,i,o){var r=Math.max(1e-6,e.finite(e.defaults(i.start,i.startValue,1))),u=Math.max(1e-6,e.finite(e.defaults(i.end,i.endValue,0))),s=e.finite(e.defaults(t.$context.toSeconds(i.dur,i.duration),1));return n("expTo",t,r,u,s,o)})}},{}],46:[function(t,e){e.exports=function(t){"use strict";function e(e,n,i){var o=e.$context,r=o.createGain();return r.channelCount=1,r.channelCountMode="explicit",r.channelInterpretation="speakers",o.connect(i,r),new t.Unit({outlet:r})}t.register("mono",function(t,n,i){return e(t,n,i)})}},{}],47:[function(t,e){e.exports=function(t,e){"use strict";function n(t){for(var n=1,i=[],o=0,r=t.length;r>o;o++)"number"==typeof t[o]?n*=t[o]:i.push(t[o]);return{multiple:e.finite(n),nodes:i}}function i(e,n,i){var o=e.$context;if(0===i)return new t.DC(o,0);if(0===n.length)return new t.DC(o,i);if(1===n.length&&1===i)return n[0];1!==i&&n.push(i);for(var u,s=n[0],a=1,c=n.length;c>a;a++)u=r(o,n[a]),o.connect(s,u),s=u;return s}function o(e){return new t.Unit({outlet:e})}function r(t,e){var n=t.createGain();return"number"==typeof e?n.gain.value=e:(n.gain.value=0,t.connect(e,n.gain)),n}t.register("*",function(t,e,r){var u=n(r);return o(i(t,u.nodes,u.multiple))})}},{}],48:[function(t,e){e.exports=function(t){"use strict";function e(e,o){var r=o.$context,u=r.createBufferSource();return u.buffer=t.KVS.get(i+e,r,n),u.loop=!0,new t.Unit({outlet:u,start:function(t){u.start(t)},stop:function(t){u.stop(t)}})}var n=4,i="@neume:noise:";t.register("noise",function(t,n){var i={pink:"pink",brown:"brown"}[n.type]||"white";return e(i,t)}),["white","pink","brown"].forEach(function(n){t.register(n,function(t){return e(n,t)})}),t.KVS.set(i+"white",function(t,e){for(var n=t.sampleRate*e,i=new Float32Array(n),o=0,r=i.length;r>o;o++)i[o]=2*Math.random()-1;var u=t.createBuffer(1,n,t.sampleRate);return u.getChannelData(0).set(i),u}),t.KVS.set(i+"pink",function(t,e){for(var n,i=t.sampleRate*e,o=new Float32Array(i),r=0,u=0,s=0,a=0,c=0,l=0,f=0,h=0,p=o.length;p>h;h++)n=2*Math.random()-1,r=.99886*r+.0555179*n,u=.99332*u+.0750759*n,s=.969*s+.153852*n,a=.8665*a+.3104856*n,c=.55*c+.5329522*n,l=-.7616*l-.016898*n,o[h]=r+u+s+a+c+l+f+.5362*n,o[h]*=.11,f=.115926*n;var d=t.createBuffer(1,i,t.sampleRate);return d.getChannelData(0).set(o),d}),t.KVS.set(i+"brown",function(t,e){for(var n,i=t.sampleRate*e,o=new Float32Array(i),r=0,u=0,s=o.length;s>u;u++)n=2*Math.random()-1,o[u]=(r+.02*n)/1.02,r=o[u],o[u]*=3.5;var a=t.createBuffer(1,i,t.sampleRate);return a.getChannelData(0).set(o),a})}},{}],49:[function(t,e){e.exports=function(t,e){"use strict";function n(n,i,o){function r(t){var n=e.finite(s.toSeconds(t.playbackTime)),i=e.defaults(t.value,t.count,0);e.isFinite(i)&&s.sched(n,function(t){u(i,t)})}function u(t,e){a.update(t,e)}var s=n.$context,a=new t.Param(s,e.finite(i.value),i),c=o.length?a.toAudioNode(o):a;return new t.Unit({outlet:c,methods:{setValue:r}})}t.register("number",function(t,e,i){return n(t,e,i)})}},{}],50:[function(t,e){e.exports=function(t,e){"use strict";function n(n,i,o){function r(t){var n=e.finite(f());n!==p&&(d.update(n,t),p=n);var i=Math.max(h,e.finite(u.toSeconds(c)));l=u.sched(t+i,r)}var u=n.$context,s=e.defaults(i.value,0),a=e.defaults(i.key,""),c=e.defaults(i.interval,.25),l=0,f=null;f="string"!=typeof a&&"number"!=typeof a||!s.hasOwnProperty(a)?function(){return s.valueOf()}:"function"==typeof s[a]?function(){return s[a]()}:function(){return s[a]};var h=1/u.sampleRate,p=e.finite(f()),d=new t.Param(u,p,i),m=o.length?d.toAudioNode(o):d;return new t.Unit({outlet:m,start:function(t){r(t)},stop:function(){u.unsched(l),l=0}})}t.register("object",n),t.register("Float32Array",n)}},{}],51:[function(t,e){(function(t){e.exports=function(e,n){"use strict";function i(t,n,i,u){var s=u.length?r(t,n,i,u):o(t,n,i),a=s.outlet,c=s.ctrl;
return new e.Unit({outlet:a,start:function(t){c.start(t)},stop:function(t){c.stop(t)}})}function o(t,e,n){var i=u(e.$context,t,n,440);return{outlet:i,ctrl:i}}function r(t,e,n,i){var o=e.$context,r=u(o,t,n,2),s=e.$context.createGain();return s.gain.value=0,o.connect(r,s.gain),o.connect(i,s),{outlet:s,ctrl:r}}function u(t,e,i,o){var r=t.createOscillator();s(e)?r.setPeriodicWave(e):r.type=e,r.frequency.value=0,r.detune.value=0;var u=t.toFrequency(n.defaults(i.freq,i.frequency,o)),a=n.defaults(i.dt,i.detune,0);return t.connect(u,r.frequency),t.connect(a,r.detune),r}function s(e){return!!(t.PeriodicWave&&e instanceof t.PeriodicWave)}function a(t,n){return e.KVS.get(c+n,t)}var c="@neume:osc",l={sin:"sine",square:"square",saw:"sawtooth",tri:"triangle"};e.register("osc",function(t,e,n){var o=t.$context,r=e.type;return s(r)||(r=a(o,l[r]||"sine")),i(r,t,e,n)}),e.register("PeriodicWave",function(t,e,n){var o=e.value;return s(o)||(o="sine"),i(o,t,e,n)}),Object.keys(l).forEach(function(t){var n=l[t];e.register(t,function(t,e,o){return i(a(t.$context,n),t,e,o)})}),e.KVS.set(c+"sine","sine"),e.KVS.set(c+"square",function(t){for(var e=new Float32Array(4096),n=new Float32Array(4096),i=1;4096>i;i++)i%2===1&&(n[i]=1/i);return t.createPeriodicWave(e,n)}),e.KVS.set(c+"sawtooth",function(t){for(var e=new Float32Array(4096),n=new Float32Array(4096),i=1;4096>i;i++)n[i]=1/i,i%2===0&&(n[i]*=-1);return t.createPeriodicWave(e,n)}),e.KVS.set(c+"triangle",function(t){for(var e=new Float32Array(4096),n=new Float32Array(4096),i=1,o=n.length;o>i;i++)i%2&&(n[i]=1/(i*i),i%4===3&&(n[i]*=-1));return t.createPeriodicWave(e,n)})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],52:[function(t,e){e.exports=function(t,e){"use strict";function n(n,i,r){var u=n.$context,s=u.createGain(),a=u.createGain();s.channelCount=1,s.channelCountMode="explicit",s.channelInterpretation="speakers",a.channelCount=1,a.channelCountMode="explicit",a.channelInterpretation="speakers";var c=e.defaults(i.pos,i.pan,0);if("number"==typeof c)c=.5*e.clip(c,-1,1)+.5,s.gain.value=Math.cos(c*Math.PI*.5),a.gain.value=Math.sin(c*Math.PI*.5);else{var l=u.createWaveShaper(),f=u.createWaveShaper(),h=t.KVS.get(o+"curve");l.curve=h.L,f.curve=h.R,u.connect(c,l),u.connect(c,f),s.gain.value=0,a.gain.value=0,l.connect(s.gain),f.connect(a.gain)}var p=u.createChannelMerger(2);return s.connect(p,0,0),a.connect(p,0,1),u.connect(r,s),u.connect(r,a),new t.Unit({outlet:p})}var i=t.WS_CURVE_SIZE,o="@neume:pan2:";t.register("pan2",function(t,e,i){return n(t,e,i)}),t.KVS.set(o+"curve",function(){for(var t=new Float32Array(i),e=new Float32Array(i),n=0;i>n;n++)t[n]=Math.cos(n/i*Math.PI*.5),e[n]=Math.sin(n/i*Math.PI*.5);return{L:t,R:e}})}},{}],53:[function(t,e){e.exports=function(t,e){"use strict";function n(e,n,i,o){var r=n.$context,u=r.createWaveShaper();return e instanceof Float32Array&&(u.curve=e),u.oversample={"2x":"2x","4x":"4x"}[i.oversample]||"none",r.connect(o,u),new t.Unit({outlet:u})}var i=t.WS_CURVE_SIZE,o="@neume:shaper:";t.register("shaper",function(i,r,u){var s=null;if("number"==typeof r.curve){var a=Math.floor(256*e.clip(e.finite(r.curve),0,1));s=t.KVS.get(o+a,a)}else s=r.curve;return n(s,i,r,u)}),t.register("clip",function(e,i,r){var u=t.KVS.get(o+"0");return n(u,e,i,r)}),function(){function e(t){for(var e,n=new Float32Array(i),o=2*t/(1-t),r=0;i>r;r++)e=2*r/i-1,n[r]=(1+o)*e/(1+o*Math.abs(e));return n}function n(t){return function(){return e(t)}}for(var r=1;256>r;r++)t.KVS.set(o+r,n(r/256))}(),t.KVS.set(o+"0",function(){for(var t=new Float32Array(i),e=0;i>e;e++)t[e]=e/i*2-1;return t}),t.KVS.set(o+"256",function(){for(var t=new Float32Array(i),e=i>>1,n=0;i>n;n++)t[n]=e>n?-1:1;return t})}},{}],54:[function(t,e){"use strict";var n={};n.isArray=function(t){return Array.isArray(t)},n.isBoolean=function(t){return"boolean"==typeof t},n.isDictionary=function(t){return null!=t&&t.constructor===Object},n.isFunction=function(t){return"function"==typeof t},n.isFinite=function(t){return"number"==typeof t&&isFinite(t)},n.isNaN=function(t){return t!==t},n.isNull=function(t){return null===t},n.isNumber=function(t){return"number"==typeof t&&!isNaN(t)},n.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&null!==t},n.isString=function(t){return"string"==typeof t},n.isTypedArray=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Int8Array||t instanceof Uint16Array||t instanceof Int16Array||t instanceof Uint32Array||t instanceof Int32Array||t instanceof Float64Array||t instanceof Uint8ClampedArray},n.isUndefined=function(t){return void 0===t},n.toArray=function(t){return null==t?[]:Array.prototype.slice.call(t)},n.clipAt=function(t,e){return t[Math.max(0,Math.min(0|e,t.length-1))]},n.wrapAt=function(t,e){return e=0|e,e%=t.length,0>e&&(e+=t.length),t[e]},n.foldAt=function(t,e){e=0|e;var n=2*t.length-2;return e%=n,0>e&&(e+=n),t.length<=e&&(e=n-e),t[e]},n.definePropertyIfNotExists=function(t,e,n){return t.hasOwnProperty(e)||Object.defineProperty(t,e,n),t},n.format=function(t,e){return Object.keys(e).forEach(function(n){/^\w+$/.test(n)&&(t=t.replace(new RegExp("#\\{"+n+"\\}","g"),e[n]))}),t},n.num=function(t){return+t||0},n.int=function(t){return 0|+t},n.finite=function(t){return t=+t||0,n.isFinite(t)||(t=0),t},n.clip=function(t,e,n){return Math.max(e,Math.min(t,n))},n.typeOf=function(t){if(n.isNumber(t))return"number";if(n.isArray(t))return"array";if(n.isString(t))return"string";if(n.isFunction(t))return"function";if(n.isBoolean(t))return"boolean";if(n.isNull(t))return"null";if(n.isUndefined(t))return"undefined";if(n.isNaN(t))return"nan";var e;return t.constructor&&("string"==typeof t.constructor.$name?e=t.constructor.$name:t.constructor.name&&"string"==typeof t.constructor.name&&(e=t.constructor.name)),e||(e=Object.prototype.toString.call(t).slice(8,-1)),"Object"===e&&(e="object"),e},n.defaults=function(t,e,n){return null!=t?t:null!=e?e:n},n.inherits=function(t,e){t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})},e.exports=n},{}]},{},[1]);
//# sourceMappingURL=neume.min.js.map